with profile as 
(select 
        sm.shipper_id
       ,pf.shopee_uid
    --    ,length(cast(pf.uid as varchar)) as check_2
    --    ,substr(cast(sm.shipper_id as varchar ),length(cast(pf.uid as varchar)) - 3,length(cast(pf.uid as varchar))) as check_3
       ,LOWER(TRIM(pf.last_name))||' '||LOWER(TRIM(pf.first_name))||' '||substr(cast(sm.shipper_id as varchar ),length(cast(pf.uid as varchar)) - 3,length(cast(pf.uid as varchar))) as check_1 
       ,sm.shipper_name
       ,sm.city_name
       ,substr(cast(pf.birth_date as varchar),1,4) as year_of_birth 
       ,pf.main_phone
       ,2022 - cast(substr(cast(pf.birth_date as varchar),1,4) as bigint) as age
       ,pf.gender
       ,date(from_unixtime(pf.create_time - 3600)) as onboard_date  
       ,date_diff('day',date(from_unixtime(pf.create_time - 3600)),current_date ) as seniority
       ,CASE WHEN sm.shipper_type_id = 11 then 'Non Hub'
             WHEN pf.working_time_id = 1 then '5 hour shift'
             WHEN pf.working_time_id = 2 then '8 hour shift'
             WHEN pf.working_time_id = 3 then '10 hour shift'
             else 'Others' end as driver_type
    --    ,pf.main_phone
    --    ,pf.secondary_phone              

from shopeefood.foody_mart__profile_shipper_master sm 

left join shopeefood.foody_internal_db__shipper_profile_tab__reg_daily_s0_live pf on pf.uid = sm.shipper_id

-- select * from shopeefood.foody_internal_db__shipper_profile_tab__reg_daily_s0_live

where sm.grass_date = 'current'

and sm.city_name not like '%Test%'

and sm.shipper_status_code = 1 
)
select  
        check_1
       ,shipper_name
       ,city_name 
       ,shipper_id,shopee_uid,main_phone,driver_type 



from profile

where check_1 in 
('nguyễn hữu nghĩa 6833',
'nguyễn ngọc đan 9441',
'trần tuấn kiệt 5348',
'trần ngọc đoan tran 3330',
'lê thành đại 5527',
'phan văn đức 801',
'nguyễn thiên ân 4626',
'nguyễn huỳnh quốc tuấn 7983',
'nguyễn phương đông 7665',
'lê trung vĩnh 4375',
'lê đức tài 205',
'trần khả tú 820',
'hoàng gia huy 7592',
'nguyễn trọng hậu 7116',
'phạm quang huy 7538',
'võ trung quân 3126',
'nguyễn thị thu hiền 7414',
'trần anh hoàng 7242',
'hoàng xuân hưng 6815',
'võ minh hoàng 1374',
'trần công nghĩa 695',
'nguyễn trung kiên 5516',
'huỳnh thị nhã phương 1238',
'đoàn vĩnh quốc 4383',
'nguyễn minh đạt 9656',
'nguyễn huy hoàng 8050',
'võ hoàng thành 9436',
'nguyễn thành tài 3861',
'lê đình dũng 9063',
'đỗ thiện phúc 792',
'đặng văn đợi 8435',
'nguyễn hải sơn 9777',
'nguyễn trường vinh 5293',
'nguyễn doãn phú 8655',
'hoàng ngọc huy 3937',
'sâm quốc huy 1947',
'nguyễn đình thiều 5484',
'lê phú huy 3910',
'phan đức nhân 2016',
'trần quan đỉnh 7085',
'lê trần anh khoa 2215',
'trịnh võ minh kiệt 3220',
'hàn quốc 1055',
'nguyễn đức phong 189',
'ngô tuấn hào 5586',
'ngô văn thêm 7944',
'nguyễn minh trí 287',
'võ phi long 6396',
'nguyễn nhựt nam 7020',
'nguyễn thanh hoa 8790',
'thạch bình huy 3773',
'vũ phi long 776',
'lê ngọc lâm 6882',
'trần tú linh 2441',
'võ thạch thiện lành 4385',
'chu trần nhất 5107',
'trần tú linh 2441',
'phạm văn đạt 8874',
'trần ngọc đức 1012',
'nguyễn minh ngọc 4503',
'phạm tiến phương nam 5483',
'đặng văn thành danh 2092',
'lê sĩ tuấn 4918',
'hứa minh tài 4184',
'lê thanh hiền 9411',
'lê quang huy 8022',
'nguyễn văn văn 5212',
'võ kim ngân 716',
'nguyễn thanh liêm 3505',
'nguyễn minh dũng 6182',
'trần anh duy 2510',
'lê vinh quang 946',
'nguyễn thanh phương 4095',
'nguyễn quốc đăng 9123',
'trương ngọc sơn 595',
'phạm kim phụng 3278',
'châu bích ngọc 5992',
'đoàn văn nhựt 6500',
'phạm văn nghĩa 3498',
'lê văn tài 7376',
'nguyễn lý hoàng anh 8351',
'trần văn dàng 1741',
'nguyễn văn trường 1996',
'nguyễn thanh tùn 8459',
'trần minh tuấn 3890',
'đặng chí thanh 2879',
'nguyễn lê đắc hiển 9244',
'tôn thất huỳnh khang 7362',
'huỳnh mai an phú 8516',
'lục chấn phong 2857',
'trịnh đức phong 608',
'lý hồng hoàng 8672',
'nguyễn minh hiếu 7125',
'nguyễn tuấn kha 7207',
'nguyễn đức minh 9345',
'đàm phan đức 951',
'nguyễn huy vũ 7785',
'phạm văn tân thịnh 3888',
'trần quang khôi 4242',
'lưu danh anh quốc 5673',
'phạm thuỳ dương 7158',
'nguyễn đức hùng 1581',
'bùi trần tuấn huy 77',
'phan xuân thiên 9817',
'nguyễn lê đức nam 1206',
'ngô chí lương 9983',
'bùi văn minh 8984',
'phạm văn đức 5355',
'nguyễn hồng thanh 3208',
'nguyễn đức hòa 1156',
'thân trịnh nguyên 2969',
'lã hồng lĩnh 6728',
'bùi ngọc tài 7084',
'lê văn vinh 3790',
'nguyễn như bình 6732',
'trần xuân tiến 9345',
'nguyễn huy sĩ 1020',
'lê văn bình 8947',
'nguyễn văn nhật 7638',
'nguyễn tấn phát 1364',
'lê hồng quân 4029',
'phan hải quân 2296',
'đinh duy anh phương 4079',
'nguyễn thiện khải 1272',
'trần chí hẹn 459',
'phạm quốc toàn 3952',
'lê chí thắng 9640',
'trần thanh quang 1163',
'trịnh duy đức 2934',
'nguyễn hoàng nhật long 8399',
'bùi ngọc linh 5880',
'nguyễn thanh toàn tâ 1185',
'phạm hoàng anh 7569',
'trần trung hiế 4486',
'đinh văn duy 4171',
'nguyễn đức hà 5281',
'trần minh hiếu 595',
'trần thanh bình 7327',
'bùi thuỳ dung 1584',
'lê huy thắng 9505',
'nguyễn thị hồng nhung 8743',
'bùi ngọc hoàng trung 5618',
'nguyễn thành đạt 7236',
'phạm bá thiện 6899',
'nguyễn viết nhật quang 7266',
'trần ngọc trí 6677',
'trần xuân mão 8281',
'võ phương huy 9756',
'phạm thái thịnh 2532',
'phạm thanh tâm 3220',
'bùi minh hải 4912',
'nguyễn văn hoà 8896',
'an văn định 9230',
'võ thanh thiện 4664',
'bùi tấn kiệt 2792',
'trần võ văn tòng 2704',
'trần đức trung 6413',
'võ minh cường 4140',
'nguyễn ngọc mởn 9086',
'le ngọc vũ 9007',
'trần đăng hải 5428',
'nguyễn công thành 3780',
'nguyễn văn hiếu 6773',
'văn xuân tuấn 989',
'lê tấn đạt 7396',
'phạm văn tuấn 8503',
'lê huy hoàng 567',
'đinh văn thắng 5231',
'trần minh thuận 1234',
'nguyễn thành vinh 2592',
'nguyên gia huy 8122',
'nguyễn tiến lực 594',
'phạm minh tuyến 7703',
'bùi thái châu 2864',
'nguyễn đăng hoàng anh 4824',
'lê trung hải 6156',
'ngô ngọc lân 3001',
'hoàng tùng dương 5202',
'nguyễn ngọc đức 2640',
'lê ngọc thành 533',
'trương anh quốc 4830',
'lê anh hào 9088',
'phạm trọng bằng 1446',
'nguyễn văn thiệp 992',
'phạm duy khánh 3221',
'vũ trường giang 202',
'nguyễn minh hiếu 9032',
'danh thành lâm 4481',
'tô minh tiến 7176',
'lê doãn hảo 8997',
'phạm thành trung 4050',
'dương hồng thái 8556',
'trần thế võ 2122',
'nguyễn thái hoàng 4480',
'trần cẩm long 5540',
'nguyễn duy tiên 2720',
'nguyễn thúy vi 1270',
'ngô thành công 2962',
'lê trường anh nam 3645',
'phạm phi hổ 2250',
'nguyễn việt đức 6800',
'nguyễn đức hiền 9248',
'nguyễn hữu huy 7695',
'nguyễn trịnh phát 1746',
'nguyễn ngọc tân 679',
'đặng ngọc sơn 3176',
'nguyễn văn tiến 5540',
'hồ ngọc hiền 9922',
'phan công định 2467',
'trần anh tuấn 4295',
'nguyễn huy hoàng 4123',
'trịnh vĩnh toàn 432',
'lê mạnh toàn 5647',
'trần trung thiện 9662',
'lê quốc dương 5521',
'lê vũ thái hoàng 7518',
'trần xuân đức 3040',
'hoàng quốc tấn 4908',
'trần quốc anh 6867',
'nguyễn văn đạt 2348',
'nguyễn ngọc hoàng ngân 406',
'trần tuấn anh + 22 1869',
'trần công hoàng 1370',
'trần vũ đại danh 3860',
'phạm quốc hưng 2178',
'tăng trần quang lộc 2018',
'trần nguyên phúc 6778',
'trần đức minh phát 1672',
'đỗ hiệp tường 1054',
'nguyễn ngọc thiên kim 7703',
'trần trung khán 4650',
'nguyễn công vũ 6968',
'phùng mạnh cường 199',
'huỳnh thị kim thoa 5764',
'ngô đức duy 7878',
'nguyễn trung tuyên 3277',
'nguyễn đình đại 3259',
'nguyễn minh trung 7976',
'trần trương quốc hùng 4495',
'phungminhduc 4519',
'ngô minh miền 9214',
'đỗ hữu tùng thoảng 2911',
'nguyễn văn tí 457',
'tô thanh tùng 8638',
'nguyễn xuân cầm 4547',
'trần phạm thanh tùng 7739',
'nguyễn trần công kha 7359',
'nguyễn thị ngọc diễm 7439',
'phạm văn vũ 6433',
'phạm đình hiệp 6886',
'trần đăng kha 2618',
'nguyễn thuận duy 6164',
'nguyễn văn tăng 438',
'đinh duy tân 3245',
'đặng thanh tùng 4048',
'đặng ngọc hoàng lâm 9630',
'nguyễn tấn biết 9684',
'trần đẵng 7896',
'trần quí thường hữu nhơn 6793',
'lê phan minh trí 5344',
'nguyễn văn nhớ 8207',
'trần quang vinh 6267',
'hoàng trung hiếu 5262',
'nguyễn thị minh châu 4914',
'lê ngọc bảo nguyên 8837',
'đặng thu ngân 9056',
'trần phúc hảo+22 3837',
'nguyễn phúc toàn 3639',
'nguyễn quốc quý 8893',
'lương quang khải 8447',
'phạm tuấn việt 5937',
'nguyễn tuấn anh 4716',
'nguyễn minh hiếu 3401',
'dương bá thắng 4760',
'lê văn tuấn 233',
'võ công danh 5250',
'tống văn mạnh 1836',
'châu hớn bình 9876',
'dương quốc khánh 7506',
'võ văn thông minh 5789',
'nguyễn minh đạt 6843',
'trần quốc đạt 2827',
'nguyễn quốc huy 6688',
'nguyễn trọng hữu 5497',
'nguyễn bảo quốc hào 7760',
'lê tiến thành 9923',
'nguyễn quốc dương 9151',
'bùi trần khánh duy 1523',
'đồng văn tiến 9390',
'nguyễn ngọc hồng phượng 976',
'nguyễn thế bảo 6482',
'vũ tiến mạnh 9823',
'cao hoàng sơn 1194',
'nguyễn phi long 8221',
'trần văn tình 6199',
'lâm chí hùng 5779',
'nguyễn tiến thành 6932',
'nguyễn quang huy 367',
'nguyễn tuấn anh 1743',
'nông hải anh 273',
'nguyễn tấn tài 3245',
'trần quang vinh 6629',
'nguyễn ngọc hưng 9250',
'võ quang sơn 6201',
'ngô quang tới 2441',
'phan thị mỹ linh 7254',
'nguyễn duy kha 6508',
'huỳnh tuấn thi 9710',
'ninh năng lực 5927',
'lê minh kha 1526',
'huỳnh tấn phát 1029',
'nguyễn thị lâm quyên 9287',
'bùi huy anh 57',
'nguyễn minh vương 1944',
'phan minh chiến 3060',
'nguyễn thanh thảo 9419',
'đỗ cao cường 5412',
'phạm ngọc thanh 3931',
'lê xuân hiệp 2063',
'nguyễn thành nhân 9002',
'nguyễn duy khang 9837',
'đỗ xuân tình 5945',
'nguyễn lam sơn 8055',
'phan quốc phước 7625',
'phạm văn định 4167',
'hoàng mạnh long 4034',
'nguyễn minh hiếu 4034',
'ngô thị thúy 8786',
'phạm tuấn vũ 4079',
'bùi chung ty 4727',
'lê văn nhật 9277',
'phí hoàng thanh nguyên 3454',
'lê minh quý 816',
'đinh quốc cường 2507',
'bùi phạm đức anh 2732',
'đinh tấn đạt 8509',
'nguyễn ngọc huy 5118',
'lê ngọc thiện 2412',
'thái thanh tuấn 6544',
'tạ nguyễn tấn lực 1618',
'võ văn tính 2771',
'cao minh tuấn 9801',
'nguyễn thị thanh tuyền 7705',
'dương ngọc phong 783',
'nguyễn văn hiển 1092',
'nguyễn ngọc hải 3711',
'lê ngọc thuấn 9862',
'lê trí nhân 9725',
'đinh nhật duy 476',
'vương văn hưng 4419',
'quách gia lộc 6525',
'cao minh tùng 331',
'phạm văn điền 8453')


-- select * from shopeefood.foody_partner_db__shipper_face_recognition_image_review_tab__reg_daily_s0_live
